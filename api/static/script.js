function prevANDnext(){return[document.getElementById("page-prev"),document.getElementById("page-next")]}function disableButton(e){e.disabled=!0,e.className="btn nav disabled"}function enableButton(e){e.disabled=!1,e.className="btn nav active"}function pageLoading(){var[e,t]=prevANDnext();disableButton(e),disableButton(t)}function pageCharged(){var[e,t]=prevANDnext();enableButton(e),enableButton(t)}function pageChange(){pageLoading();const e=new Image;return e.onload=function(){document.getElementById("original").src=e.src,pageCharged()},e}function getConsts(){var e=parseInt(document.getElementById("first-page").value),t=parseInt(document.getElementById("last-page").value);const n=document.getElementById("original").src;var o=n.split("/").slice(0,-1).join("/"),i=n.split("/").pop().split(".")[1],r=n.split("/").pop().split(".")[0];return[e,t,o,i,r=parseInt(r)]}function newSrc(e,t,n){return e+"/"+n+"."+t}function prevPage(){const e=pageChange();var[t,,n,o,i]=getConsts();t<i?e.src=newSrc(n,o,i-1):pageCharged()}function nextPage(){const e=pageChange();var[,t,n,o,i]=getConsts();i<t?e.src=newSrc(n,o,i+1):pageCharged()}function resetForm(){confirm("Êtes-vous sûr de vouloir réinitialiser votre correction ?\nToutes les modifications seront perdues. (À jamais !)")&&(document.getElementById("ocr-form").reset(),alert("Votre correction a bien été réinitialisée."))}function submitForm(){var e=confirm("Êtes-vous sûr de vouloir soumettre votre correction ?");if(e){document.getElementById("send").disabled=!0;var t=document.getElementById("ocr").value,n=document.getElementById("ocr-original").value;if(t!==n||confirm("Votre correction ne contient aucune modification.\nÊtes-vous sûr de vouloir soumettre votre correction ?")){e=document.getElementById("ocr-form"),e=new FormData(e);const o=new XMLHttpRequest;o.open("POST","/submit",!0),o.onload=function(){200===o.status?alert("Votre correction a bien été soumise."):(document.getElementById("send").disabled=!1,alert("Une erreur est survenue lors de la soumission de votre correction."))},o.send(e),setTimeout(function(){location.reload()},1e3)}else document.getElementById("send").disabled=!1}}function bad(){if(confirm('Si vous êtes sur une image ne correspondant pas au texte actuel, veuillez naviguer jusqu\'à la bonne page.\nPar la suite, vous pouvez valider la nouvelle page en cliquant sur le bouton "Bonne page".')){const e=document.getElementById("bad");e.disabled=!0,e.style.display="none";const t=document.getElementById("good");t.disabled=!1,t.style.display="inline-block",document.getElementById("ocr").disabled=!0,document.getElementById("good-page").value="NOPE"}}function good(){alert("Nouvelle correspondance enregistrée.");const e=document.getElementById("good");e.disabled=!0,e.style.display="none";const t=document.getElementById("bad");t.disabled=!1,t.style.display="inline-block",document.getElementById("ocr").disabled=!1;const n=document.getElementById("original").src;var o=n.split("/").pop().split(".")[0];console.log("URL: "+n+" ID: "+o),document.getElementById("corresponding").value=o}function passer(){var e=document.getElementById("ocr").value,t=document.getElementById("ocr-original").value;if(e!==t&&!confirm("Votre correction contient des modifications.\nÊtes-vous sûr de vouloir passer à la page suivante sans soumettre votre correction ?"))return;location.reload()}function getCookie(){const e=new XMLHttpRequest;return e.open("get","/read_cookie",!1),e.send(),e.responseText}function setCookie(e){const t=new XMLHttpRequest;t.open("get","/set_cookie",!1),t.send(e)}function init(){null===JSON.parse(getCookie()).mazette&&(console.log("Empty cookie, first visit ? "),setCookie())}window.onbeforeunload=function(){return document.getElementById("ocr").value!==document.getElementById("ocr-original").value?"Attention ! Vous avez des modifications non sauvegardées.":null},init();
